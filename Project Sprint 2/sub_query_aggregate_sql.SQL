#(Subquery)1.Find the total amount spent by each customer
SELECT c.customer_id, c.first_name, c.last_name, SUM(t.amount) AS total_spent
FROM Customers c
JOIN Rentals r ON c.customer_id = r.customer_id
JOIN Transactions t ON r.rental_id = t.rental_id
GROUP BY c.customer_id
ORDER BY c.customer_id;
#(Subquery)2. List all customers who have rented a console that is currently under maintenance
SELECT DISTINCT c.customer_id, c.first_name, c.last_name
FROM Customers c
JOIN Rentals r ON c.customer_id = r.customer_id
JOIN Inventory i ON r.inventory_id = i.inventory_id
WHERE i.status = 'Maintenance';
#(subquery)3. Find the most recent rental details for each customer
SELECT c.customer_id, c.first_name, c.last_name, MAX(r.rental_start_date) AS last_rental_date
FROM Customers c
JOIN Rentals r ON c.customer_id = r.customer_id
GROUP BY c.customer_id;
#(aggregate)1.Find the total number of rentals for each customer
SELECT
    c.customer_id,
    c.first_name,
    c.last_name,
    COUNT(r.rental_id) AS total_rentals
FROM Customers c
LEFT JOIN Rentals r ON c.customer_id = r.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name;

#(aggregate)2.Find the average rental cost for each type of console
SELECT
    con.model,
    SUM(t.amount) AS total_revenue
FROM Consoles con
JOIN inventory inv ON con.console_id = inv.console_id
JOIN Rentals r ON r.inventory_id = inv.inventory_id
JOIN Transactions t ON r.rental_id = t.rental_id
GROUP BY con.model;

#(aggregate)3.Find the total revenue generated by each console model
SELECT
    con.model,
    SUM(t.amount) AS total_revenue
FROM Consoles con
JOIN inventory inv ON con.console_id = inv.console_id
JOIN Rentals r ON r.inventory_id = inv.inventory_id
JOIN Transactions t ON r.rental_id = t.rental_id
GROUP BY con.model;
